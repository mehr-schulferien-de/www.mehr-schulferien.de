<ol class="breadcrumb">
  <li class="breadcrumb-item active"><%= "#{round(@number_of_days / 7)}" %> Wochen VergleichsÃ¼bersicht</li>
</ol>

<div class="row">
  <div class="col-xs-12">
    <h1><mark class="school-holiday">Schulferien</mark> und <mark class="public-holiday">Feiertage</mark></h1>
    <p>Die BundeslÃ¤nder verlinken auf die jeweiligen Ferien und Feiertage. Von dort kommen Sie auch auf alle 14.522 Orte und 23.432 Schulen (teilweise mit beweglichen Ferientagen).</p>

    <div id="big_table">
    <%= render MehrSchulferienWeb.PartialView, "_current_calendar.html", conn: @conn, countries: @countries, days: @days, day_names: @day_names, months: @months %>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <h2 style="display: flex; align-items: center; gap: 0.5em;">
      <span class="icon-calendar" style="font-size:1.2em;">ğŸ“…</span>
      BrÃ¼ckentage
    </h2>
    <% teaser = case MehrSchulferienWeb.PageView.best_bridge_day_teaser() do
      {percent, min_leave, max_days, year, _starts_on, _ends_on} ->
        """
        <div style="font-weight:600; color:#357abd; margin-bottom:0.5em;">
          Bis zu #{percent}% mehr freie Tage mÃ¶glich!
          <span style="font-weight:400; color:#444;">
            Beispiel: Mit nur #{min_leave} Urlaubstag#{if min_leave > 1, do: "en", else: ""} in NRW kÃ¶nnen Sie #{max_days} Tage frei machen
            (<a href=\"#{Routes.bridge_day_path(@conn, :show_within_federal_state, "d", "nordrhein-westfalen", year)}\" style=\"color:#357abd; text-decoration:underline;\">Beispiel ansehen</a>).
          </span>
        </div>
        """
      _ -> ""
    end %>
    <%= raw(teaser) %>
    <div class="alert alert-info" style="margin-bottom:1em;">
      <strong>Mehr Urlaub mit weniger Urlaubstagen!</strong><br>
      Nutzen Sie BrÃ¼ckentage fÃ¼r eine clevere Urlaubsplanung. <a href="https://de.wikipedia.org/wiki/BrÃ¼ckentag" target="_blank" rel="noopener">Was ist ein BrÃ¼ckentag?</a>
    </div>
    <p>
      Unser Algorithmus zeigt nicht nur normale <a href="https://de.wikipedia.org/wiki/BrÃ¼ckentag">BrÃ¼ckentage</a>, sondern auch
      die Variationen, in denen 2 bis 4 genommene Urlaubstage ein Vielfaches an effektivem
      Urlaub realisieren.
    </p>
    <div class="table-wrapper" style="margin-top:1em;">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Bundesland</th>
            <%= if Enum.any?(@countries, fn country -> 
                 Enum.any?(country[:federal_states], fn federal_state -> 
                   length(federal_state.years_with_bridge_days) > 0 
                 end)
               end) do %>
              <th colspan="<%= length(@countries |> hd() |> get_in([:federal_states]) |> hd() |> Map.get(:years_with_bridge_days)) %>">Jahr</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <%= for place <- @countries do %>
            <% country = place[:country] %>
            <% federal_states = place[:federal_states] %>
            <%= for federal_state <- federal_states do %>
              <tr>
                <td><%= federal_state.name %></td>
                <%= if length(federal_state.years_with_bridge_days) > 0 do %>
                  <%= for year <- federal_state.years_with_bridge_days do %>
                    <td><%= link year, to: Routes.bridge_day_path(@conn, :show_within_federal_state, country.slug, federal_state.slug, year), class: "btn btn-sm btn-outline-primary" %></td>
                  <% end %>
                <% end %>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
